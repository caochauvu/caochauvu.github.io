<!DOCTYPE html>  
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>20150205_140000_bio_414_lecture_notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style id="mkstylesheet">
body{-webkit-font-smoothing:antialiased;font-family:"Helvetica Neue",Helvetica,Arial,Verdana,sans-serif;margin:30px 0 0;padding:0;background:#fff}#wrapper{padding:20px}li{font-size:110%}li li{font-size:100%}li p{font-size:100%;margin:.5em 0}h1{color:#000}h2{color:#111}h3{color:#111;margin:0}h4{color:#111}h5{color:#111}h6{font-size:1em;line-height:1.5em;margin:1.5em 0}body,p,td,div{color:#111;font-family:"Helvetica Neue",Helvetica,Arial,Verdana,sans-serif;word-wrap:break-word}a{color:#0d6ea1;text-decoration:none;-webkit-transition:color 0.2s ease-in-out;-moz-transition:color 0.2s ease-in-out;-o-transition:color 0.2s ease-in-out;-ms-transition:color 0.2s ease-in-out;transition:color 0.2s ease-in-out}a:hover{color:#3593d9}body{font-size:15px;line-height:21px;margin:0 auto}h1{font-size:37px;line-height:42px;margin-top:42px;margin-bottom:21px}h2{font-size:27px;line-height:42px;margin-top:42px;margin-bottom:21px}h3{font-size:20px;line-height:21px;margin-top:21px;margin-bottom:21px}h4{font-size:20px;line-height:21px;margin-top:21px;margin-bottom:21px}p,ul,ol,pre,table,blockquote{margin-top:21px;margin-bottom:21px}hr{border:1px solid;margin:-1px 0}ul ul,ol ol,ul ol,ol ul{margin-top:0;margin-bottom:0}b,strong,em,small,code{line-height:1}.footnote{color:#0d6ea1;font-size:.8em;vertical-align:super}abbr,acronym{border-bottom:1px dotted #aaa}#wrapper img{max-width:100%;height:auto}dd{font-size:1em;margin-bottom:1em}li>p:first-child{margin:0}ul ul,ul ol{margin-bottom:.4em}caption,col,colgroup,table,tbody,td,tfoot,th,thead,tr{border-spacing:0}table{border:1px solid rgba(0,0,0,0.25);border-collapse:collapse;display:table;empty-cells:hide;margin:-1px 0 1.3125em;padding:0;table-layout:fixed}caption{display:table-caption;font-weight:700}col{display:table-column}colgroup{display:table-column-group}tbody{display:table-row-group}tfoot{display:table-footer-group}thead{display:table-header-group}td,th{display:table-cell}tr{display:table-row}table th,table td{font-size:1.1em;line-height:1.3;padding:.5em 1em 0}table thead{background:rgba(0,0,0,0.15);border:1px solid rgba(0,0,0,0.15);border-bottom:1px solid rgba(0,0,0,0.2)}table tbody{background:rgba(0,0,0,0.05)}table tfoot{background:rgba(0,0,0,0.15);border:1px solid rgba(0,0,0,0.15);border-top:1px solid rgba(0,0,0,0.2)}figure{display:inline-block;overflow:hidden;position:relative;margin:1em 0 2em}figcaption{font-style:italic;text-align:center;background:white;color:#666}.poetry pre{display:block;font-family:Georgia,Garamond,serif !important;font-size:110% !important;font-style:italic;line-height:1.6em;margin-left:1em}.poetry pre code{font-family:Georgia,Garamond,serif !important;word-break:break-all;word-break:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;white-space:pre-wrap}blockquote p{font-size:110%;font-style:italic;line-height:1.6em}sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;position:relative;vertical-align:super}sub{vertical-align:sub;top:-1px}p,h5{font-size:1.1429em;line-height:1.3125em;margin:1.3125em 0}dt,th{font-weight:700}table tr:nth-child(odd),table th:nth-child(odd),table td:nth-child(odd){background:rgba(255,255,255,0.06)}table tr:nth-child(even),table td:nth-child(even){background:rgba(200,200,200,0.25)}@media print{img,table,figure{page-break-inside:avoid}#wrapper{background:#fff;color:#303030;padding:10px;position:relative;text-indent:0}}@media screen{.inverted{background:#252a2a}.inverted #wrapper{background:#252a2a;color:#eee}.inverted hr{border-color:#333f40 !important}.inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted th,.inverted .math,.inverted caption,.inverted dt,.inverted dd{color:#eee}.inverted pre{background:#ccc}.inverted pre code{color:#111}.inverted table{background:none}.inverted table tr:nth-child(odd),.inverted table td:nth-child(odd){background:none}.inverted a{color:#acd1d5}::selection{background:rgba(157,193,200,0.5)}h1::selection{background-color:rgba(45,156,208,0.3)}h2::selection{background-color:rgba(90,182,224,0.3)}h3::selection,h4::selection,h5::selection,h6::selection,li::selection,ol::selection{background-color:rgba(133,201,232,0.3)}code::selection{background-color:rgba(0,0,0,0.7);color:#eee}code span::selection{background-color:rgba(0,0,0,0.7) !important;color:#eee !important}a::selection{background-color:rgba(255,230,102,0.2)}.inverted a::selection{background-color:rgba(255,230,102,0.6)}td::selection,th::selection,caption::selection{background-color:rgba(180,237,95,0.5)}}

@media print{
#generated-toc-clone,#generated-toc{display:none!important}
}
#generated-toc-clone li.missing,#mkreplaced-toc li.missing{list-style-type:none!important}#generated-toc-clone li, #mkreplaced-toc li{list-style-type:upper-roman}#generated-toc-clone li li, #mkreplaced-toc li li{list-style-type:decimal}#generated-toc-clone li li li,#mkreplaced-toc li li li{list-style-type:decimal-leading-zero}#generated-toc-clone li li li li,#mkreplaced-toc li li li li{list-style-type:lower-greek}#generated-toc-clone li li li li li,#mkreplaced-toc li li li li li{list-style-type:disc}#generated-toc-clone li li li li li li,#mkreplaced-toc li li li li li li{list-style-type:square}
</style>

</head>
<body class="normal firstload">
  <div id="wrapper">
      <p>20150205_140000_bio_414_lecture_notes </p>

<h1 id="notes">Notes</h1>

<h2 id="parsimonycontinued">Parsimony Continued</h2>

<h3 id="generalizedparsimony">Generalized Parsimony</h3>

<p>We added 1 for every substitution required to explain site data, this corresponds to a (step) matrix like: </p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"></th>
	<th style="text-align:left;">A</th>
	<th style="text-align:left;">G</th>
	<th style="text-align:left;">C</th>
	<th style="text-align:left;">T</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">A</td>
	<td style="text-align:left;">0</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">1</td>
</tr>
<tr>
	<td style="text-align:left;">G</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">0</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">1</td>
</tr>
<tr>
	<td style="text-align:left;">C</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">0</td>
	<td style="text-align:left;">1</td>
</tr>
<tr>
	<td style="text-align:left;">T</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">0</td>
</tr>
</tbody>
</table>

<p>What if we wanted to account for transition/ transversion bias, we can adjust the values in the (step) matrix.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"></th>
	<th style="text-align:center;">A</th>
	<th style="text-align:center;">G</th>
	<th style="text-align:center;">C</th>
	<th style="text-align:center;">T</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">A</td>
	<td style="text-align:center;">0</td>
	<td style="text-align:center;"><span class="math">\(\alpha\)</span></td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
</tr>
<tr>
	<td style="text-align:left;">G</td>
	<td style="text-align:center;"><span class="math">\(\alpha\)</span></td>
	<td style="text-align:center;">0</td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
</tr>
<tr>
	<td style="text-align:left;">C</td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
	<td style="text-align:center;">0</td>
	<td style="text-align:center;"><span class="math">\(\alpha\)</span></td>
</tr>
<tr>
	<td style="text-align:left;">T</td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
	<td style="text-align:center;"><span class="math">\(\beta\)</span></td>
	<td style="text-align:center;"><span class="math">\(\alpha\)</span></td>
	<td style="text-align:center;">0</td>
</tr>
</tbody>
</table>

<p>Where <span class="math">\(\alpha\)</span> is the transition rate and <span class="math">\(\beta\)</span> is the transversion rate.</p>

<p><strong>Problem</strong> Transition and transversion rate are different in different data set. It can be very hard to estimate. Parsimony doesn&#8217;t have a strong way of estimating these rates.</p>

<h3 id="weightedparsimony">Weighted Parsimony</h3>

<p>Rapidly evolving sites should be downweighted since they can create too much noise. Whereas less slower evolving sites should be upweighted.</p>

<p>After scoring site <span class="math">\(i\)</span> with score <span class="math">\(l_{i}\)</span>, you can combine it with weight <span class="math">\(w_{i}\)</span> to get a weighted sum</p>

<p><span class="math">\[\sum_{i} w_{i} l_{i}\]</span></p>

<p>However again you don&#8217;t have a principled way to select weights.</p>

<h3 id="parsimonyscoring">Parsimony Scoring</h3>

<p>More data leads to less accurate parsimony reconstruction (topology/ phylogeny). Usually we want <strong>consistency</strong>, where the more data we feed an equation/ model, the more accurate the results it should give.</p>

<p>Parsimony usually fails with certain tree shapes. Suppose your true tree (unrooted here) has two long branches and two short branches, with 1 and 3 having long branch, 2 and 4 having short branches.</p>

<p><span class="math">\[((1,2), (3,4))\]</span></p>

<p>Where there is the following:</p>

<ol>
<li>A</li>
<li>C</li>
<li>A</li>
<li>C</li>
</ol>

<p>Parsimony would construct a tree like:</p>

<p><span class="math">\[((1,3), (2,4))\]</span></p>

<p>Parsimony would find it&#8217;s more likely that 1/3 are together and 2/4 together (1 changes vs 2). This phenomena is known as <strong>long branch attraction</strong>. </p>

<h2 id="maximumlikelihood">Maximum Likelihood</h2>

<h3 id="coinexample">Coin Example</h3>

<p>Data: </p>

<p><span class="math">\[y_{1}, ...,y_{n}\]</span></p>

<p>Where:</p>

<p><span class="math">\[y_{i} = 1\ for\ heads\]</span>
<span class="math">\[y_{i} = 0\ for\ tails\]</span></p>

<p>The probability ias as follow:</p>

<p><span class="math">\[Pr(y_{i} = 1) = p\]</span>
<span class="math">\[Pr(y_{i} = 0) = 1-p\]</span>
<span class="math">\[Pr(y_{i}) = p^{y_{i}} (1-p)^{1-y_{i}}\]</span></p>

<p>Flips are independent so: </p>

<p><span class="math">\[Pr(y_{i}) = Pr(y_{1})*...*Pr(y_{n})\]</span>
<span class="math">\[Pr(y_{i}) = p^{\sum_{i}y_{i}} * (1-p)^{\sum_{i}1-y_{i}}\]</span>
<span class="math">\[Pr(y_{i}) = p^k(1-p)^{n-k}\]</span></p>

<p>Where k is the number of occurrence of events we&#8217;re observing and n is the total number of observations.</p>

<p>If we plot the probability of data against <span class="math">\(p\)</span>, the <span class="math">\(p\)</span> that maximizes the probability of observing the data is best estimate of what is happening, it is our <span class="math">\(\hat{p}\)</span>. </p>

<p>In our case: </p>

<p><span class="math">\[\hat{p} = \frac{k}{n}\]</span></p>

<h3 id="generalformulation">General Formulation</h3>

<p>Suppose we observe data <span class="math">\(\vec{y}\)</span>. We have a probabilistic model with parameters <span class="math">\(\vec{\theta}\)</span>. This model allow us to calculate the probability/ likelihood of observing data: <span class="math">\(L(\vec{y}; \vec{\theta}) = Pr(\vec{y};\vec{\theta}\)</span>. Parameters that maximize <span class="math">\(L(\vec{y}; \vec{\theta})\)</span>, \hat{\vec{\theta}}, are called maximum likelihood estimation (MLEs). </p>

<p>MLE is consistent under very general conditions: if our model is correct and we collect more and more data, MLEs will converge to the true parameters. </p>

<h3 id="phylogeneticmle">Phylogenetic MLE</h3>

<p>Suppose we have the following data (alignment)</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;"><span class="math">\(y_{1}\)</span></th>
	<th style="text-align:center;"><span class="math">\(y_{2}\)</span></th>
	<th style="text-align:center;"><span class="math">\(y_{2}\)</span></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><span class="math">\(y_{11}\)</span></td>
	<td style="text-align:center;"><span class="math">\(y_{12}\)</span></td>
	<td style="text-align:center;"><span class="math">\(y_{13}\)</span></td>
</tr>
<tr>
	<td style="text-align:center;"><span class="math">\(y_{21}\)</span></td>
	<td style="text-align:center;"><span class="math">\(y_{22}\)</span></td>
	<td style="text-align:center;"><span class="math">\(y_{23}\)</span></td>
</tr>
<tr>
	<td style="text-align:center;">.</td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;"></td>
</tr>
<tr>
	<td style="text-align:center;">.</td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;"></td>
</tr>
<tr>
	<td style="text-align:center;"><span class="math">\(y_{k1}\)</span></td>
	<td style="text-align:center;"><span class="math">\(y_{k2}\)</span></td>
	<td style="text-align:center;"><span class="math">\(y_{k3}\)</span></td>
</tr>
</tbody>
</table>

<p>Suppose you have 2 taxa with:</p>

<p>Sequence 1 = AC
Sequence 2 = CC</p>

<p>If we know that A is the ancestor, we would need to calculate the probability: </p>

<p><span class="math">\[Pr\begin{pmatrix}
A\\C 
\end{pmatrix} 
= Pr(A \rightarrow A)*Pr(A \rightarrow C)\]</span></p>
<div style="display:none"><br/>
<!--This seemingly unnecessary div markup is the only thing keeping this script working after Markdown conversion. Trust me.--><br/>
 <script type="text/x-mathjax-config">  
  MathJax.Hub.Config({
    
  });  
</script><br/>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><br/>
</div>
<!-- ##END MARKED WRAPPER## -->
    </div>
</body>
</html>